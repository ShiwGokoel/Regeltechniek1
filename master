#include <Stepper.h>

#define STEPS 32
#define IN1 11
#define IN2 10
#define IN3 9
#define IN4 8

Stepper stepper(STEPS, IN4, IN2, IN3, IN1);
#define joystick A0

void setup() {
  // Set pin modes for motor control pins
  pinMode(IN1, OUTPUT);
  pinMode(IN2, OUTPUT);
  pinMode(IN3, OUTPUT);
  pinMode(IN4, OUTPUT);
}

void loop() {
  int val = analogRead(joystick);

  // If the joystick is centered, stop the motor
  if (val >= 500 && val <= 512) {
    stepper.setSpeed(0);
    stepper.step(0);
  }
  // If the joystick is moved to the right, move the motor forward
  else if (val > 512 && val <= 1023) {
    int speed_ = map(val, 512, 1023, 5, 500);
    stepper.setSpeed(speed_);
    stepper.step(1);
  }
  // If the joystick is moved to the left, move the motor backward
  else if (val >= 0 && val < 500) {
    int speed_ = map(val, 0, 500, 1000, 5);
    stepper.setSpeed(speed_);
    stepper.step(-1);
  }
}
